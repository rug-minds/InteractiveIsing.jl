<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>WeightGenerators · InteractiveIsing Documentation</title><meta name="title" content="WeightGenerators · InteractiveIsing Documentation"/><meta property="og:title" content="WeightGenerators · InteractiveIsing Documentation"/><meta property="twitter:title" content="WeightGenerators · InteractiveIsing Documentation"/><meta name="description" content="Documentation for InteractiveIsing Documentation."/><meta property="og:description" content="Documentation for InteractiveIsing Documentation."/><meta property="twitter:description" content="Documentation for InteractiveIsing Documentation."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../usage/">InteractiveIsing Documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../usage/">General Usage</a></li><li><span class="tocitem">Details</span><ul><li><a class="tocitem" href="../IsingGraphs/">IsingGraphs</a></li><li><a class="tocitem" href="../Indexing/">Indexing</a></li><li class="is-active"><a class="tocitem" href>WeightGenerators</a><ul class="internal"><li><a class="tocitem" href="#Why-Metaprogramming?"><span>Why Metaprogramming?</span></a></li><li><a class="tocitem" href="#Constructing-WeightGenerators"><span>Constructing WeightGenerators</span></a></li><li><a class="tocitem" href="#Getting-the-weight"><span>Getting the weight</span></a></li></ul></li><li><a class="tocitem" href="../GeneratingAdj/">Generating Adjacency Lists</a></li><li><a class="tocitem" href="../Defects/">Defects</a></li><li><a class="tocitem" href="../Loops/">Loops</a></li><li><a class="tocitem" href="../Parameters/">Parameters</a></li><li><a class="tocitem" href="../Algorithms/">Algorithms</a></li><li><a class="tocitem" href="../Hamiltonians/">Hamiltonians</a></li><li><a class="tocitem" href="../Analysis/">Analysis</a></li><li><a class="tocitem" href="../Processes/">Processes</a></li><li><a class="tocitem" href="../Topology/">Topology</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Details</a></li><li class="is-active"><a href>WeightGenerators</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>WeightGenerators</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/rug-minds/InteractiveIsing.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/rug-minds/InteractiveIsing.jl/blob/main/docs/src/man/WeightGenerator.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="WeightGenerator"><a class="docs-heading-anchor" href="#WeightGenerator">WeightGenerator</a><a id="WeightGenerator-1"></a><a class="docs-heading-anchor-permalink" href="#WeightGenerator" title="Permalink"></a></h1><p>Weight generators are structs that use some metaprogramming to turn a description of a function dependent on coordinates in the lattice of an IsingLayer into a weight. The details of weightgenerators may change, but the interface should remain fairly stable.</p><p>A <code>WeightGenerator</code> holds descriptions of the following things:</p><ul><li><p>A julia anonymous function that describes how to generate the weight from the following arguments:   <code>[dr,dx,dy,dz,x,y,z]</code> where <code>dr</code> is the relative distance between two spins, <code>dx, dy, dz</code> are displacements in the <code>x, y</code> and <code>z</code> coordinates respectively   <code>x, y, z</code> are the averaged coordinate of the two spins, starting at one at the top left of a lattice, where <code>y</code> counts up going downwards.</p><p>The function given may accept any combination of these coordinates</p></li><li><p>A julia anonymous function describing how to generate the self energy of a spin (i.e. <span>$J_ii$</span>) from the following arguments:   <code>[x, y, z]</code> which are the lattice coordinates of a spin.</p></li><li><p>A description of a distribution from which a number is sampled which is <strong>added to</strong> the generated weight.   I.e. <code>Normal(μ,σ)</code> would add a random number generated from a normal distribution with mean <code>μ</code> and standard deviation <code>σ</code> to the weight generated from the function above.</p></li></ul><ul><li><p>A description of a distribution from which a number is sampled which is <strong>multiplied with</strong> the generated weight.   I.e. using <code>[-1,1]</code>, a random sign can be will be sampled with equal probability which is mulitplied with the weight.</p></li><li><p>The amount of nearest neighbors for which a weight needs to be generated. This may be given as a single integer or a tuple of integers. A tuple must be given to have at least the amount of dimensions of the layer the generator will be applied to. The numbers in the tuple will represent the amount of nearest neighbors that will be taken into account when generating connections, let&#39;s call the entries <span>$(N_x, N_y, N_z)$</span>, where the numbers correspond to the <span>$x,y$</span> and <span>$z$</span> axis respectively. This means that in the <span>$x$</span> direction, only spins with a relative <span>$x$</span> distance of maximally <span>$N_x$</span> will be considered when generating weights, and so on for <span>$y$</span> and <span>$z$</span>.</p></li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>At first sight this might seem redundant, because we can program a distance cutoff in the generating function that we supply, i.e. <code>(dr) -&gt; dr &lt; 3 ? somefunc(dr) : 0</code> which ensures that all weights for distances greater than 3 are zero. However, julia code cannot know beforehand wether some arbitrary function causes a distance cutoff. Thus, all combinations of spins would need to be checked to see if they produce a zero weight. This is computationally quite prohibitive because every combination of two spins has to be checked. Thus the normal computation time for generating the weights would be on the order of <span>$N_{spins}^2$</span>, where <span>$N_{spins} \sim L^d$</span>, where L is the dimension of the material. With this method we have scaling of <span>$N_{spins} * {NN}^d$</span>, where typically <span>${NN}^d &lt;&lt; L^d$</span>, which drastically improves computation time for most type of local connectivity, where the connections are negligible after a limited distance anyway.</p></div></div><h2 id="Why-Metaprogramming?"><a class="docs-heading-anchor" href="#Why-Metaprogramming?">Why Metaprogramming?</a><a id="Why-Metaprogramming?-1"></a><a class="docs-heading-anchor-permalink" href="#Why-Metaprogramming?" title="Permalink"></a></h2><p>Metaprogramming allows for flexible definition of the weights, like choosing which arguments are neccesary and chooshing whether or not to have a self energy or distirbution term, while still being performant. A user can now just write <code>(dx, dy) -&gt; somefunc(dx,dy)</code> which will be handled by the metaprogramming code. If metaprogramming wouldn&#39;t be used, any description of the function would need to include all possible arguments, even if they are not used <code>(dr,dx,dy,dx,x,y,z) -&gt; somefunc(dx,dy)</code> to ensure consistent working with the functions in the module that generate the adjacency lists from these weights.</p><p>Performance is also key because the amount of weights generated for even a simple lattice might otherwise already be prohibitive in terms of computation time.</p><h2 id="Constructing-WeightGenerators"><a class="docs-heading-anchor" href="#Constructing-WeightGenerators">Constructing WeightGenerators</a><a id="Constructing-WeightGenerators-1"></a><a class="docs-heading-anchor-permalink" href="#Constructing-WeightGenerators" title="Permalink"></a></h2><p>Because we need metaprogramming capabities, weightgenerators are not generated through a normal julia function, but a macro, <code>@WG</code>, which returns a regular julia struct. It accepts the following</p><pre><code class="nohighlight hljs">wg = @WG &quot;(args) -&gt; somefunc(...)&quot; selfWeight = &quot;(selfargs) -&gt; someselffunc(...)&quot; addDist = &quot;Dist(...)&quot; multDist = &quot;Dist(...)&quot; NN = 3</code></pre><p>Where args is any combination of the arguments <code>[dr, dx, dy, dz, x, y, z]</code>, and selfargs is any combination of <code>[x,y,z]</code>. For the interpretations of the arguments see the first section <a href="#WeightGenerator">WeightGenerator</a>.</p><p>The first argument and the keyword argument are required. Except for the argument <code>NN</code>, which is given as an int, all other arguments are given as strings, otherwise containing normal julia code.</p><p>The distributions may be given in two ways. The first is to provide any julia code that may be filled into <code>rand</code>. I.e. <code>Normal(μ,σ)</code> may be used as <code>rand(Normal(μ,σ))</code> to generate numbers from a normal distribution, or <code>[-1,1]</code> may be used as <code>rand([-1,1])</code> to generate an integer from that list with equal probability. We may also give any <code>rand(...)</code> function directly, for example to produce numbers from a list with inhomogeneous probability.</p><h3 id="Redundancy"><a class="docs-heading-anchor" href="#Redundancy">Redundancy</a><a id="Redundancy-1"></a><a class="docs-heading-anchor-permalink" href="#Redundancy" title="Permalink"></a></h3><p>There is a bit of redundancy built in for convenience&#39;s sake. The <code>addDist</code> and <code>multDist</code> arguments provide global distributions which also could have been given through the weight generating function itself. This however keeps the code a bit cleaner and easier to read.</p><h2 id="Getting-the-weight"><a class="docs-heading-anchor" href="#Getting-the-weight">Getting the weight</a><a id="Getting-the-weight-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-the-weight" title="Permalink"></a></h2><p>We can get the weight from a weightgenerator with</p><pre><code class="nohighlight hljs">getWeight(wg::WeightGenerator; dr = 0, dx = 0, dy = 0, dz = 0, x = 0, y = 0, z = 0)</code></pre><p>where the arguments not used by the function given during construction simply have no effect.</p><p>We can get the self weight with</p><pre><code class="nohighlight hljs">getSelfWeight(wg::WeightGenerator; x = 0, y = 0, z = 0)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Indexing/">« Indexing</a><a class="docs-footer-nextpage" href="../GeneratingAdj/">Generating Adjacency Lists »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Tuesday 3 September 2024 23:08">Tuesday 3 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
