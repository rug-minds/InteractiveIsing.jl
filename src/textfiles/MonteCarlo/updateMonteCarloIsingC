function updateMonteCarloIsingC(rng)
    T = TIs[]

    beta = T>0 ? 1/T : Inf

    idx = rand(rng, g_iterator)
     
    oldstate = g.state[idx]

    efactor = getEFactor(g,idx, htype)

    newstate = sampleCState()
    
    Ediff = deltE(efactor,newstate,oldstate)
    if (Ediff < 0 || rand() < exp(-beta*Ediff))
        @inbounds g.state[idx] = newstate 
    end
end