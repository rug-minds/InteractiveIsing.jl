function updateMonteCarloIsingD()

    beta = 1/(s_TIs[])
    
    idx = rand(rng, g_iterator)
    
    Estate = @inbounds g.state[idx]*getEFactor(g.state,idx, ghtype)

    minEdiff = 2*Estate

    if (Estate >= 0 || rand(rng) < exp(beta*minEdiff))
        @inbounds g.state[idx] *= -1
    end
    
end